---
title: "Research project"
author: "Sofiia Folvarochna, Anastasiia Beheni, Olesia Omelchuk"
output: html_notebook
---

```{r}
library(tidyr)
library(dplyr)
library(ggplot2)
library(MASS)
```

```{r}
data <- read.csv("udemy_dataset.csv")
data <- data[, c(5,6,7,8,9,10,12)]
data$course_level[data$course_level == "Beginner"] <- 0
data$course_level[data$course_level == "Intermediate"] <- 1
data$course_level[data$course_level == "Expert"] <- 2
data$course_level[data$course_level == "All Levels"] <- 3
data$course_level <- as.integer(data$course_level)
#data <- data[data$coures_reviews < 200, ]
#nrow(data)
```

```{r}
hist(data$course_rating, col = "#cc33ff", border = "white", main="Distribution of courses' ratings", breaks = seq(1,5,0.1))
box(bty="l")
grid(nx=NA,ny=NULL,lty=1,lwd=1,col="lightgrey")
```

```{r}
data$high <- data$course_rating >= 4
summary(data)
```

```{r}
ggplot(data, aes(x=price,fill=factor(high)))+geom_density(alpha=0.5)+
 xlab(label = "Price")+
 ggtitle("Distribution of price")+
 theme_minimal()
```

```{r}
ggplot(data, aes(x=price,fill=factor(course_level)))+geom_density(alpha=0.5)+
 xlab(label = "Price")+
 ggtitle("Distribution of price")+
 theme_minimal()
```

```{r}
hist(data$course_level, col = "#99CC99", border = "white", main="Distribution of courses' ratings", breaks = seq(-1,3))
box(bty="l")
```

```{r}
correlation <- cor(data)
print(correlation[, "coures_reviews"])
```

```{r}
number_of_enrollmenters <- unique(data$course_enrollmenters)
l.0 <- c()
l.1 <- c()
l.2 <- c()
l.3 <- c()

for (i in number_of_enrollmenters){
  l.0 <- c(l.0, nrow(data[data$course_level == 0 & data$course_enrollmenters == i,]))
  l.1 <- c(l.1, nrow(data[data$course_level == 1 & data$course_enrollmenters == i,]))
  l.2 <- c(l.2, nrow(data[data$course_level == 2 & data$course_enrollmenters == i,]))
  l.3 <- c(l.3, nrow(data[data$course_level == 3 & data$course_enrollmenters == i,]))
}
df <- data.frame(l.0,l.1,l.2,l.3, row.names = number_of_enrollmenters)
df
chisq.test(df)
```

```{r}
number_of_enrollmenters <- unique(data$price)
r.2 <- c()
r.3 <- c()
r.4 <- c()
r.5 <- c()

for (i in number_of_enrollmenters){
  r.2 <- c(r.2, nrow(data[data$course_rating <= 2.5 & data$price == i,]))
  r.3 <- c(r.3, nrow(data[data$course_rating > 2.5 & data$course_rating <= 3.5 & data$price == i,]))
  r.4 <- c(r.4, nrow(data[data$course_rating > 3.5 & data$course_rating <= 4.5 & data$price == i,]))
  r.5 <- c(r.5, nrow(data[data$course_rating > 4.5 & data$price == i,]))
}
df1 <- data.frame(r.2,r.3,r.4,r.5, row.names = number_of_enrollmenters)
df1
chisq.test(df1)
```

```{r}
ratings <- unique(data$course_rating)

l.0 <- c()
l.1 <- c()
l.2 <- c()
l.3 <- c()

for (i in ratings){
  l.0 <- c(l.0, nrow(data[data$course_level == 0 & data$course_rating == i,]))
  l.1 <- c(l.1, nrow(data[data$course_level == 1 & data$course_rating == i,]))
  l.2 <- c(l.2, nrow(data[data$course_level == 2 & data$course_rating == i,]))
  l.3 <- c(l.3, nrow(data[data$course_level == 3 & data$course_rating == i,]))
}
df2 <- data.frame(l.0,l.1,l.2,l.3, row.names = ratings)

chisq.test(df2)
```
